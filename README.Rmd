---
title: "CADIA Accompanying Manual and Walk Through"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## File guides

This page contains the code and documentation of CADIA package. 

In the folder KEGGPATHS, you can find the XML files of the original pathways. In the folder TestCodes, you can find the test cases and codes for the accompaniying publications. The rest of this document showcases how to use CADIA. 




## Package Installation and Preparation

You can install CADIA using devtool library. To install devtool run the following commnad:
```{r, eval =FALSE }
install.packages("devtool")

```

After having `devtools` installed, you can install `CADIA` from its github repository

```{r, eval =FALSE }
library(devtools)
devtools::install_github("pouryany/CADIA")
```


## Example Data Analysis

If you have a prepared list of differential expression data skip to the next part. 

Here, we will use an example data from an ovarian cancer data set from NCBI GEO (GSE12172). Make sure the libraries are installed and updated. Selecting differentially expressed genes and proper filtering.

```{r}
library(CADIA)

data(tT)
# Filter out unannotated and duplicated genes
tT.filter    <- tT[!is.na(tT$Gene.ID),]
tT.filter    <- tT.filter[!duplicated(tT.filter$Gene.ID),]

# Select a p-value and fold-change cut-off for differential expressions
tT.deGenes   <- tT.filter[tT.filter$adj.P.Val < 0.05, ]
tT.deGenes   <- tT.deGenes[abs(tT.deGenes$logFC) >1,]

# Parameters needed for CADIA. The name of all genes and DE genes.
tT.all.names <- as.vector(tT.filter$Gene.ID)
tT.de.names  <- as.vector(tT.deGenes$Gene.ID)
```




## Pathway Enrichment Analysis with CADIA

Just run the following code. The first argument is the ENTREZ ID of the differentially expressed genes. The second argument is the ENTREZ ID of all genes from the experiment. 

```{r, message= FALSE, warning= FALSE}

## CADIA uses random sampling, make sure to set the random seed for reproducing
set.seed(1)
tT.pathways <- causalDisturbance(tT.de.names,tT.all.names,iter = 10000)
head(tT.pathways)
```

In the above results, P_ORA is the p-value of hypergeometric test. P_SSC is the p-value of Source-Sink Centrality, Causal Disturbance is the combined p-value, and CADIA is the FDR corrected causal disturbance.
